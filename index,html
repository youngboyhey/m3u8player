<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>m3u8 代理播放測試</title>
    <script src="https://cdn.jsdelivr.net/npm/artplayer/dist/artplayer.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js/dist/hls.min.js"></script>
    <style>
        body { margin: 0; background: #111; color: white; font-family: sans-serif; text-align: center; }
        #player { width: 100%; max-width: 720px; height: 405px; margin: 40px auto; }
    </style>
</head>
<body>
    <h2>m3u8代理播放測試</h2>
    <div id="player"></div>
    <script>
        const proxyUrl = "https://noisy-dawn-9a87.youngboyhey.workers.dev/?url=" + encodeURIComponent("https://media-hls.doppiocdn.org/b-hls-01/196205035/196205035_960p.m3u8?playlistType=lowLatency&psch=v1&pkey=Zokee2OhPh9kugh4&_HLS_msn=1687&_HLS_part=2");

        function playM3u8(video, url, art) {
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(video);
                art.hls = hls;
                art.on('destroy', () => hls.destroy());
            } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                video.src = url;
            } else {
                art.notice.show = '無法播放 m3u8 串流';
            }
        }

        new Artplayer({
            container: '#player',
            url: proxyUrl,
            type: 'm3u8',
            customType: {
                m3u8: playM3u8,
            },
            autoplay: true,
            isLive: true,
            muted: true,
        });
    </script>
</body>
</html>
